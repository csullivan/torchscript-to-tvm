tvm with unmodified torchvision

ProfileResult(mean=0.17629690307999998, results=(0.175357303, 0.176906604, 0.176058055, 0.175502454, 0.175709645, 0.176062266, 0.175541259, 0.175839263, 0.176302332, 0.175985871, 0.175300137, 0.175935311, 0.1786138, 0.176083327, 0.175007424, 0.175925426, 0.176596397, 0.179862557, 0.176920303, 0.175781157, 0.175682671, 0.176144903, 0.176389089, 0.175817467, 0.176088513, 0.176577048, 0.176742398, 0.178872737, 0.175675889, 0.175130598, 0.176268236, 0.176310867, 0.175187086, 0.175086847, 0.176670614, 0.176563244, 0.176200333, 0.176545179, 0.176302131, 0.176920154, 0.177061546, 0.176290826, 0.175660443, 0.17584813, 0.17689912, 0.17690989, 0.175697006, 0.176188175, 0.176645684, 0.177177439))

ProfileResult(mean=0.16284161424000004, results=(0.164252916, 0.163926692, 0.168457522, 0.162881345, 0.162496205, 0.161770495, 0.161864018, 0.162241765, 0.161674487, 0.16167505, 0.163534709, 0.167671609, 0.163234316, 0.161837219, 0.161860201, 0.161510426, 0.161745772, 0.161812032, 0.162984954, 0.166986158, 0.161980854, 0.162444911, 0.161446635, 0.16168705, 0.162855449, 0.162895531, 0.163831127, 0.167376531, 0.162634778, 0.162135401, 0.161429895, 0.161826045, 0.16182558, 0.161585807, 0.162966854, 0.166671169, 0.16249687, 0.161593915, 0.161726707, 0.161704061, 0.161441869, 0.161689828, 0.161552568, 0.161566556, 0.161758586, 0.161756095, 0.163291839, 0.167641016, 0.162217323, 0.161631971))

tvm with tensor array stack modification

ProfileResult(mean=0.18026734718, results=(0.183711862, 0.179335419, 0.179220694, 0.177716252, 0.177596019, 0.179346231, 0.180532725, 0.180668724, 0.181268653, 0.179525719, 0.179734154, 0.179436948, 0.180029655, 0.180415687, 0.186875265, 0.180038751, 0.179208457, 0.180744761, 0.179154907, 0.179117065, 0.179467801, 0.178451522, 0.17831904, 0.17840182, 0.179422763, 0.17942662, 0.17936329, 0.179884512, 0.180174538, 0.179908751, 0.181690717, 0.180595896, 0.180421946, 0.182294527, 0.181215392, 0.180694386, 0.179881252, 0.180136171, 0.180098515, 0.182935795, 0.180765588, 0.182601459, 0.180157319, 0.17982705, 0.180384092, 0.180447773, 0.18058933, 0.181807896, 0.180713726, 0.179609924))

tvm after scatter rewrite
ProfileResult(mean=0.16644659958, results=(0.165609409, 0.165398789, 0.165392404, 0.166475218, 0.166485489, 0.165606035, 0.16605282, 0.166006779, 0.167773655, 0.171090777, 0.166290888, 0.167130524, 0.166597285, 0.166175216, 0.165561714, 0.169139216, 0.16617452, 0.165027827, 0.166342593, 0.16549076, 0.165676469, 0.165336096, 0.16646515, 0.166378139, 0.166502916, 0.167827258, 0.167168937, 0.166182102, 0.166188019, 0.165088368, 0.166275147, 0.16745976, 0.16554582, 0.164836516, 0.165822957, 0.168090082, 0.167999874, 0.166430803, 0.168913064, 0.166203763, 0.165239971, 0.166668026, 0.166884069, 0.165087313, 0.164997377, 0.169479933, 0.165464097, 0.164979809, 0.166445528, 0.166870698))

tvm + nvptx + cudnn + cublas
ProfileResult(mean=0.11817354962000001, results=(0.124119276, 0.116829907, 0.116547748, 0.116583723, 0.117328459, 0.116922238, 0.116822588, 0.116554625, 0.116598506, 0.120293399, 0.120934761, 0.120078744, 0.120207176, 0.11770314, 0.117918517, 0.116750468, 0.116838107, 0.116731383, 0.118472003, 0.120030054, 0.119965363, 0.120716202, 0.11747344, 0.117340383, 0.117290084, 0.116551809, 0.116762407, 0.118806434, 0.118363703, 0.117752434, 0.117767569, 0.117300684, 0.116831631, 0.117397143, 0.117237736, 0.120500444, 0.12038901, 0.118091491, 0.118145007, 0.117384242, 0.117199465, 0.117040337, 0.118765534, 0.117102347, 0.120771481, 0.12076699, 0.118162263, 0.11762851, 0.118056841, 0.116851675))

tvm + nvptx + cublas + any_dim fix
ProfileResult(mean=0.12432160208000001, results=(0.128372789, 0.122958933, 0.127018479, 0.124542128, 0.12390459, 0.122605966, 0.122111994, 0.123407875, 0.128327159, 0.124159317, 0.124088417, 0.123676866, 0.122810999, 0.123465087, 0.127651277, 0.124881609, 0.123188985, 0.122927279, 0.123535163, 0.126405362, 0.1248079, 0.12325713, 0.122555905, 0.122345475, 0.122885552, 0.123726971, 0.125140476, 0.125446201, 0.123348466, 0.123184894, 0.122720948, 0.122348935, 0.123596385, 0.127678274, 0.124896816, 0.123684197, 0.123305906, 0.124114101, 0.127182629, 0.126001801, 0.123273493, 0.123315033, 0.128111463, 0.126008942, 0.123048366, 0.123357225, 0.124496233, 0.126027148, 0.123483641, 0.122689324))

tvm + cuda + cublas + cudnn + any_dim fix
ProfileResult(mean=0.12067505279999999, results=(0.121096478, 0.121458646, 0.12127863, 0.121627773, 0.121656038, 0.123946393, 0.121258597, 0.119935087, 0.120054569, 0.120068
257, 0.120084502, 0.120125994, 0.120058182, 0.120224315, 0.120449482, 0.12030941, 0.122010581, 0.121194986, 0.121101766, 0.12005057, 0.119985891, 0.119884373, 0.120300078, 0.120838482, 0.120525281, 0.121404077, 0.120608225, 0.120181427, 0.120127228, 0.120271299, 0.12059318, 0.121120554, 0.120780154, 0.119822166, 0.120371635, 0.120444034, 0.1199
51131, 0.120414877, 0.120253692, 0.120834349, 0.124136666, 0.120667643, 0.120501641, 0.120676255, 0.120265565, 0.120095916, 0.12036682, 0.120107578, 0.120218433, 0.120013734
))

tvm + nvptx + cublas + cudnn + any_dim fix
ProfileResult(mean=0.10794076765999999, results=(0.111342552, 0.108136514, 0.106749136, 0.110474289, 0.107705734, 0.106588471, 0.110976306, 0.109388748, 0.111005805, 0.107500388, 0.108557242, 0.107728316, 0.106875811, 0.108235314, 0.108386955, 0.107009977, 0.108947279, 0.107221287, 0.107965608, 0.107926702, 0.107246237, 0.110624415, 0.106931919, 0.107144063, 0.107742761, 0.107024646, 0.107540871, 0.107457422, 0.106799297, 0.107584074, 0.107386186, 0.106825234, 0.107363494, 0.107405256, 0.10840197, 0.107672928, 0.109662208, 0.107702348, 0.108294229, 0.107351768, 0.106831403, 0.107762136, 0.10716632, 0.107154972, 0.107669482, 0.107661538, 0.107018365, 0.108003994, 0.108070804, 0.106815609))

torch elapsed 0.11544324398040771
